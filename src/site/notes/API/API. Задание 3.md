---
{"dg-publish":true,"permalink":"/api/api-zadanie-3/"}
---

## Задание 3. Тестирование готового API

---

**ФИО:** 2022-ФГиИБ-ИБ-1б Максимельянов Илья Максимович

---

Был получен API приложения заправки, реализованный по моему заданию Максимом Хабаровым.

## Отчет

### Сценарий 1

#### Описание сценария
**Наиболее вероятное использование приложения стандартным пользователем**

- Регистрация пользователя
- Посмотреть отзыв на заправку или оставить свой
- Посмотреть цены на топливо
##### Этап 1. Регистрация пользователя

Выполняем POST запрос по адресу http://localhost:1337/api/polsovatels/

![Pasted image 20241001132722.png](/img/user/media/Pasted%20image%2020241001132722.png)
<center>Регистрация пользователя с некорректными данными</center>

![Pasted image 20241001132857.png](/img/user/media/Pasted%20image%2020241001132857.png)
<center>Регистрация пользователя с корректными данными</center>

**Вывод**: После выполнения запроса, были созданы два пользователя.

**Замечания**: Сразу можно заметить, что никакой верификации данных нет, можно создать пользователя с абсолютно пустыми полями. Также заметим, что для пользователя был создан отдельная коллекция, а не был использован стандартный пользователь. Также не выдаётся никакая роль, никакой начальный уровень лояльности, и поле с датой регистрации также не работает автоматически.

##### Этап 2. Посмотреть отзыв на заправку и оставить свой

Выполним POST запрос http://localhost:1337/api/reviews для того, чтобы оставить отзыв на заправку. В задании 2 Максима, описано, что `gas_id` и `user_id` будут проставляться автоматически.

![Pasted image 20241001134359.png](/img/user/media/Pasted%20image%2020241001134359.png)
<center>Пользователь успешно оставил отзыв</center>

![Pasted image 20241001134449.png](/img/user/media/Pasted%20image%2020241001134449.png)
<center>Пользователь успешно оставил пустой отзыв</center>

**Вывод**: После выполнения запроса, были созданы два отзыва.

Выполним GET запрос http://localhost:1337/api/?fields=adress&filters[adress][$contains]=Новогиреево&populate[reviews][fields]=text для того, чтобы посмотреть отзывы на заправку по адресу Новогиреево. 

![Pasted image 20241001135257.png](/img/user/media/Pasted%20image%2020241001135257.png)
<center>Отправка GET запроса для поиска отзывов</center>

**Вывод**: При запросе появилась ошибка.

**Замечания**: Нужно связать сущности отзыва и заправки. Скорее всего это связано с тем, что неправильно подвязывается id заправки и id отзыва.

##### Этап 3. Просмотр цен на бензин.
Предварительно заполним сущность бензина одной тестовой записью.

Выполняем GET запрос http://localhost:1337/api/fuels?fields=name&fields=price

![Pasted image 20241001144526.png](/img/user/media/Pasted%20image%2020241001144526.png)
<center>Отправка GET запроса для просмотра цены на бензин</center>

**Вывод**: С запросом успешно вывелась информация о бензине и его цене.

**Замечания**: Нет.
### Сценарий 2

#### Описание сценария
**Модератор приложения решил просмотреть отзывы на заправку**

Как такого разделения по ролям не реализовано, но для полноты теста мы предположим, что они у нас есть. Предположим, что у нас уже есть зарегистрированный пользователь с ролью персонала заправки.

- Менеджер решил промодерировать отзывы и нашёл отзыв, не соответствующий правилам площадки по оставлению комментариев, решил его удалить и удалить аккаунт пользователя, который его написал.

Выполняем DELETE запрос /api/reviews/1

![Pasted image 20241001153939.png](/img/user/media/Pasted%20image%2020241001153939.png)
<center>Удаление отзыва с помощью метода DELETE</center>

**Вывод**: отзыв успешно удалён.

По отзыву мы нашли id пользователя и пробуем удалить его также с помощью метода DELETE

![Pasted image 20241001154451.png](/img/user/media/Pasted%20image%2020241001154451.png)
<center>Удаление пользователя с помощью метода DELETE</center>

### Сценарий 3

#### Описание сценария
**Работнику нужно обслужить бензоколонку и изменить цены на топливо**

- Изменение даты последнего обслуживания ТРК
- Изменение цены на топливо

С помощью запроса PUT запроса мы обновили дату последнего обслуживания ТРК

![Pasted image 20241001155244.png](/img/user/media/Pasted%20image%2020241001155244.png)
<center>PUT запрос для обновления информации о ТРК</center>

![Pasted image 20241001160916.png](/img/user/Pasted%20image%2020241001160916.png)
<center>PUT запрос для обновления информации о топливе</center>

**Вывод**: все запросы успешно выполнены.
### Заключение

В заключении можно сказать что из трёх реализованных сценариев успешными оказались два последних. Первый сценарий оказался наиболее проблемным, так как не хватает нормальной верификации данных и связей между сущностями.